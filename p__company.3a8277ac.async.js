(self.webpackChunkphone_number_manager_frontend=self.webpackChunkphone_number_manager_frontend||[]).push([[726],{38763:function(S,E,a){"use strict";a.r(E);var h=a(86582),C=a(2824),s=a(39428),d=a(3182),F=a(44534),T=a(37201),I=a(7506),p=a(72899),R=a(53585),j=a(64322),U=a(53776),K=a(5966),c=a(67294),f=a(85893),$=function(b,y,g,M,L,v,Z){return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(K.Z,{width:"xl",name:"name",label:"\u5355\u4F4D\u540D\u79F0",tooltip:"\u4E0D\u80FD\u8D85\u8FC720\u4E2A\u5B57\u7B26",placeholder:"\u8BF7\u8F93\u5165\u5355\u4F4D\u540D\u79F0",rules:[{required:!0,message:"\u5355\u4F4D\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\uFF01"},{max:20,message:"\u5355\u4F4D\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC720\u4E2A\u5B57\u7B26\uFF01"}]})," ",(0,f.jsx)(I.Z,{width:"xl",name:"parentIdCascder",label:"\u4E0A\u7EA7\u5355\u4F4D",querySelectList:function(){var o=(0,d.Z)((0,s.Z)().mark(function _(u){return(0,s.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.Z.api.queryCompanySelectList([u]);case 2:return i.abrupt("return",i.sent.data);case 3:case"end":return i.stop()}},_)}));return function(_){return o.apply(this,arguments)}}(),selectList:b,setSelectList:y,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u5355\u4F4D\uFF01"},{validator:function(_,u){return typeof Z!="undefined"&&Z!=="0"&&Z===u[u.length-1]?Promise.reject(new Error("\u4E0A\u7EA7\u7F16\u53F7\u4E0D\u80FD\u4E3A\u81EA\u8EAB\uFF01")):Promise.resolve()}}]})," ",(0,f.jsx)(I.Z,{width:"xl",name:"systemPermissionSelectList",label:"\u5355\u4F4D\u6240\u5C5E\u6743\u9650",querySelectList:function(){var o=(0,d.Z)((0,s.Z)().mark(function _(u){return(0,s.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,R.Z.api.querySystemPermissionSelectList([u]);case 2:return i.abrupt("return",i.sent.data);case 3:case"end":return i.stop()}},_)}));return function(_){return o.apply(this,arguments)}}(),selectList:g,setSelectList:M,cascaderFieldProps:{multiple:!0,value:L,onChange:function(_){var u=_.flat();u[u.length-1]==="0"?v([["0"]]):u.includes("0")?v(_.slice(1)):v(_)}},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5355\u4F4D\u6240\u5C5E\u6743\u9650\uFF01"},{validator:function(_,u){return u.length>1&&u.some(function(D){return D[0]===0})?Promise.reject(new Error("\u5355\u4F4D\u6240\u5C5E\u6743\u9650\u4E0D\u80FD\u540C\u65F6\u9009\u62E9\u7CFB\u7EDF\u6743\u9650\u548C\u65E0\u6743\u9650\uFF01")):Promise.resolve()}}]})," "]})},H=function(){var b=(0,U.t)("@@initialState"),y=b.initialState,g=(0,c.useRef)(),M=(0,c.useRef)(),L=(0,c.useState)([]),v=(0,C.Z)(L,2),Z=v[0],o=v[1],_=(0,c.useState)([]),u=(0,C.Z)(_,2),D=u[0],i=u[1],k=(0,c.useState)([]),w=(0,C.Z)(k,2),q=w[0],A=w[1],G=(0,c.useState)(void 0),B=(0,C.Z)(G,2),z=B[0],O=B[1];(0,c.useEffect)(function(){(0,d.Z)((0,s.Z)().mark(function l(){var r,n;return(0,s.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[{label:"\u65E0",title:"\u65E0",value:"0"}],n=(0,j.uA)(y==null?void 0:y.currentUser),e.t0=o,e.t1=[],e.t2=r,e.t3=h.Z,e.next=8,p.Z.api.queryCompanySelectList(n);case 8:return e.t4=e.sent.data,e.t5=(0,e.t3)(e.t4),e.t6=e.t1.concat.call(e.t1,e.t2,e.t5),(0,e.t0)(e.t6),e.t7=i,e.t8=[],e.t9=r,e.t10=h.Z,e.next=18,R.Z.api.querySystemPermissionSelectList(["0"]);case 18:e.t11=e.sent.data,e.t12=(0,e.t10)(e.t11),e.t13=e.t8.concat.call(e.t8,e.t9,e.t12),(0,e.t7)(e.t13);case 22:case"end":return e.stop()}},l)}))()},[]);var W=function(r){var n;return r.systemPermissions=(n=r.systemPermissionSelectList)===null||n===void 0?void 0:n.map(function(m){return{id:m[m.length-1]}}),r.parentId=r.parentIdCascder[r.parentIdCascder.length-1][0],r};return(0,f.jsxs)(T.Z,{routes:[{path:"/welcome",breadcrumbName:"\u9996\u9875"},{path:"",breadcrumbName:"\u5355\u4F4D\u7BA1\u7406"},{path:"/company",breadcrumbName:"\u5355\u4F4D\u5217\u8868"}],children:[" ",(0,f.jsx)(F.Z,{customActionRef:g,customRequest:function(){var l=(0,d.Z)((0,s.Z)().mark(function r(n){return(0,s.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.Z.api.queryCompanyList(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},r)}));return function(r){return l.apply(this,arguments)}}(),customColumns:[{title:"\u5355\u4F4D\u540D\u79F0",dataIndex:"name",sorter:!0,ellipsis:!0}],isOptionButtons:!0,batchRemoveEventHandler:function(){var l=(0,d.Z)((0,s.Z)().mark(function r(n){return(0,s.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.Z.api.batchCompany({method:"DELETE",data:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},r)}));return function(r){return l.apply(this,arguments)}}(),modalForm:{title:"\u5355\u4F4D",element:$(Z,o,D,i,q,A,z),formRef:M,onCreateFinish:function(){var l=(0,d.Z)((0,s.Z)().mark(function n(m){return(0,s.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.Z.api.createCompany(W(m));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},n)}));function r(n){return l.apply(this,arguments)}return r}(),onModifyFinish:function(){var l=(0,d.Z)((0,s.Z)().mark(function n(m){return(0,s.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return O(void 0),t.next=3,p.Z.api.modifyCompany(m.id,W(m));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},n)}));function r(n){return l.apply(this,arguments)}return r}(),queryData:function(){var l=(0,d.Z)((0,s.Z)().mark(function n(m){var e,t;return(0,s.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,p.Z.api.queryCompany(m);case 2:return e=P.sent,e.data.systemPermissions===null||e.data.systemPermissions.length===0?e.data.systemPermissionSelectList=[["0"]]:e.data.systemPermissionSelectList=(t=e.data.systemPermissions)===null||t===void 0?void 0:t.map(function(J){return[J.id]}),A(e.data.systemPermissionSelectList),typeof e.data.parentId!="undefined"&&(e.data.parentIdCascder=[[e.data.parentId]]),O(m),P.abrupt("return",e);case 8:case"end":return P.stop()}},n)}));function r(n){return l.apply(this,arguments)}return r}(),onCancel:function(){return O(void 0)}},removeData:function(){var l=(0,d.Z)((0,s.Z)().mark(function r(n){return(0,s.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.Z.api.removeCompany(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},r)}));return function(r){return l.apply(this,arguments)}}()})," "]})};E.default=H},72899:function(S,E,a){"use strict";var h=a(73387);E.Z={api:h}},53585:function(S,E,a){"use strict";var h=a(6382);E.Z={api:h}}}]);
